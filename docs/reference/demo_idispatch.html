<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Test the interfacer idispatch functions — demo_idispatch • interfacer</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Test the interfacer idispatch functions — demo_idispatch"><meta name="description" content="Allows testing from the context of an installed package
this is here for testing purposes only. The majority of functions are
tested in testthat but one or two need package infrastructure to test
things like the documentation"><meta property="og:description" content="Allows testing from the context of an installed package
this is here for testing purposes only. The majority of functions are
tested in testthat but one or two need package infrastructure to test
things like the documentation"><meta property="og:image" content="https://ai4ci.github.io/interfacer/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">interfacer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/interfacer.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/consistency.html">Parameter consistency checking with interfacer</a></li>
    <li><a class="dropdown-item" href="../articles/devtools.html">Tools to work with `interfacer`</a></li>
    <li><a class="dropdown-item" href="../articles/dispatch.html">Multiple dispatch based on dataframes</a></li>
    <li><a class="dropdown-item" href="../articles/nesting.html">Nested dataframes and `purrr` style list columns</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ai4ci/interfacer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Test the interfacer idispatch functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/ai4ci/interfacer/blob/HEAD/R/zz-demo-functions.R" class="external-link"><code>R/zz-demo-functions.R</code></a></small>
      <div class="d-none name"><code>demo_idispatch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Allows testing from the context of an installed package
this is here for testing purposes only. The majority of functions are
tested in testthat but one or two need package infrastructure to test
things like the documentation</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">demo_idispatch</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>one of 2 possibilities - EITHER: a dataframe with columns:</p><ul><li><p>id (integer) - an integer ID</p></li>
<li><p>test (logical) - the test result</p></li>
<li><p>extra (character) - a new value</p></li>
</ul><p>Ungrouped.</p>
<p>OR with columns:</p><ul><li><p>id (integer) - an integer ID</p></li>
<li><p>test (logical) - the test result</p></li>
</ul><p>Any grouping allowed.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>passed on to methods</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list of the parameters passed to one of two functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When we run examples this should run in an isolated session so</span></span></span>
<span class="r-in"><span><span class="co"># we might be able to see visibility failures:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Should dispatch to demo_idispatch.test</span></span></span>
<span class="r-in"><span><span class="va">test_data</span> <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="co"># this is a numeric vector</span></span></span>
<span class="r-in"><span>  test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Should dispatch to demo_idispatch.test_extn</span></span></span>
<span class="r-in"><span><span class="va">test_extn_data</span> <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  extra <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  unneeded <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">new_a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dots_test_value</span> <span class="op">=</span> <span class="st">"true"</span></span></span>
<span class="r-in"><span><span class="va">tmp</span> <span class="op">=</span> <span class="fu">demo_idispatch</span><span class="op">(</span><span class="va">test_extn_data</span>, a <span class="op">=</span> <span class="va">new_a</span>, dots_test <span class="op">=</span> <span class="va">dots_test_value</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "test_extn"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $validates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          id        test       extra    unneeded </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   "integer"   "logical" "character" "character" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dots$dots_test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "true"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $a_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $b_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $defn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "function (x, ..., a = c(1, 2, 3), b = a^2) "                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "{"                                                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "    return(list(fn = \"test_extn\", validates = itest(x, i_test_extn), "  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "        types = sapply(x, class), dots = rlang::list2(...), a_value = a, "</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "        b_value = b, defn = format(demo_idispatch.test_extn)))"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "}"                                                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The value was dispatched to the correct function</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">fn</span>, <span class="st">"test_extn"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The inline value for b was evaluated correctly as `new_a^2`</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">b_value</span>, <span class="va">new_a</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the type was in fact converted during dispatch:</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">types</span><span class="op">[[</span><span class="st">"id"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"integer"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">validates</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># dynamic dots were evaluated correctly from this environment</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">dots</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dots_test <span class="op">=</span> <span class="st">"true"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmp2</span> <span class="op">=</span> <span class="fu">demo_idispatch</span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tmp2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "test"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $validates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id      test </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "integer" "logical" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> named list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $a_expr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "NULL"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $defn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "function (x, ..., a_expr = NULL) "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "{"                                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "    a_expr = rlang::enexpr(a_expr)"                                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "    return(list(fn = \"test\", validates = itest(x, i_test), types = sapply(x, "</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "        class), dots = rlang::ensyms(...), a_expr = format(a_expr), "           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "        a = eval(a_expr), defn = format(demo_idispatch.test)))"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "}"                                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp2</span><span class="op">$</span><span class="va">a</span>, <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp2</span><span class="op">$</span><span class="va">types</span><span class="op">[[</span><span class="st">"id"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"integer"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp2</span><span class="op">$</span><span class="va">validates</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp2</span><span class="op">$</span><span class="va">fn</span>, <span class="st">"test"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmp3</span> <span class="op">=</span> <span class="fu">demo_idispatch</span><span class="op">(</span><span class="va">test_data</span>, <span class="va">sym1</span>, <span class="va">sym2</span>, a_expr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">pi</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tmp3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "test"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $validates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        id      test </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "integer" "logical" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dots[[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sym1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dots[[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sym2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $a_expr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "sin(pi) + cos(pi)"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $defn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "function (x, ..., a_expr = NULL) "                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "{"                                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "    a_expr = rlang::enexpr(a_expr)"                                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "    return(list(fn = \"test\", validates = itest(x, i_test), types = sapply(x, "</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "        class), dots = rlang::ensyms(...), a_expr = format(a_expr), "           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "        a = eval(a_expr), defn = format(demo_idispatch.test)))"                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [7] "}"                                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># expression passed correctly as expression:</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp3</span><span class="op">$</span><span class="va">a_expr</span>, <span class="st">"sin(pi) + cos(pi)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># expression can be evaluated (in context):</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp3</span><span class="op">$</span><span class="va">a</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># dots can be handled as symbols:</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">tmp3</span><span class="op">$</span><span class="va">dots</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sym1"</span>, <span class="st">"sym2"</span><span class="op">)</span>, <span class="va">as.symbol</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmp4</span> <span class="op">=</span> <span class="fu">demo_idispatch</span><span class="op">(</span><span class="va">test_extn_data</span>, a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">test_extn_data</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>, b <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tmp4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "test_extn"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $validates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          id        test       extra    unneeded </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   "integer"   "logical" "character" "character" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $a_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "integer"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $b_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $defn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "function (x, ..., a = c(1, 2, 3), b = a^2) "                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "{"                                                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "    return(list(fn = \"test_extn\", validates = itest(x, i_test_extn), "  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "        types = sapply(x, class), dots = rlang::list2(...), a_value = a, "</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "        b_value = b, defn = format(demo_idispatch.test_extn)))"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] "}"                                                                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># The reference to class(test_extn_data$id) evaluates on the validated input.</span></span></span>
<span class="r-in"><span><span class="co"># This is potentially confusing but probably the best option:</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">tmp4</span><span class="op">$</span><span class="va">a_value</span>, <span class="st">"integer"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">test_extn_data</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>, <span class="st">"numeric"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robert Challen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

