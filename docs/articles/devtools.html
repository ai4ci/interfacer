<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tools to work with `interfacer` • interfacer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tools to work with `interfacer`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">interfacer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/interfacer.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/consistency.html">Parameter consistency checking with interfacer</a></li>
    <li><a class="dropdown-item" href="../articles/devtools.html">Tools to work with `interfacer`</a></li>
    <li><a class="dropdown-item" href="../articles/dispatch.html">Multiple dispatch based on dataframes</a></li>
    <li><a class="dropdown-item" href="../articles/nesting.html">Nested dataframes and `purrr` style list columns</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ai4ci/interfacer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Tools to work with `interfacer`</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ai4ci/interfacer/blob/HEAD/vignettes/devtools.Rmd" class="external-link"><code>vignettes/devtools.Rmd</code></a></small>
      <div class="d-none name"><code>devtools.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="automating-iface-specifications">Automating <code>iface</code> specifications<a class="anchor" aria-label="anchor" href="#automating-iface-specifications"></a>
</h2>
<p>Adopting <code>interfacer</code> for package functions can go hand in
hand with developing test data for the project. In this scenario a
function that relies on a specific dataframe format, can be defined
using the test data as a prototype to help generate the
<code>iface</code> specification.</p>
<p>This is the role of <code>iclip</code> and <code>use_iface</code>.
Suppose we wish to develop a function that supports datasets in the same
format as <code>mtcars</code> we can use the <code>mtcars</code> dataset
as a prototype by calling <code>iclip(mtcars)</code>. This writes a
<code>iface</code> specification to the clipboard. Pasting it gives
us:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i_mtcars</span> <span class="op">=</span> <span class="fu">interfacer</span><span class="fu">::</span><span class="fu"><a href="../reference/iface.html">iface</a></span><span class="op">(</span></span>
<span>    mpg <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the mpg column"</span>,</span>
<span>    cyl <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the cyl column"</span>,</span>
<span>    disp <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the disp column"</span>,</span>
<span>    hp <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the hp column"</span>,</span>
<span>    drat <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the drat column"</span>,</span>
<span>    wt <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the wt column"</span>,</span>
<span>    qsec <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the qsec column"</span>,</span>
<span>    vs <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the vs column"</span>,</span>
<span>    am <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the am column"</span>,</span>
<span>    gear <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the gear column"</span>,</span>
<span>    carb <span class="op">=</span> <span class="va">numeric</span> <span class="op">~</span> <span class="st">"the carb column"</span>,</span>
<span>    .groups <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If we instead called <code>use_iface(mtcars)</code> this definition
would be written to the file <code>R/interfaces.R</code> (or the
definition updated if it is already present). <code>iface</code>
specifications can be anywhere in the package hierarchy but it does make
some sense to keep them all in one file. Interface specifications do not
need to be exported from a package to function (although they can
be).</p>
<p>In both cases as the developer you will want to update the default
column description, if the <code>use_iface</code> function was used,
care must be taken to ensure changes you make will not be over written
if <code>use_iface</code> is called again. This is a question of
removing the relevant comment in <code>R/interfaces.R</code></p>
</div>
<div class="section level2">
<h2 id="dataframe-documentation">Dataframe documentation<a class="anchor" aria-label="anchor" href="#dataframe-documentation"></a>
</h2>
<p>When using <code><a href="https://usethis.r-lib.org/reference/use_data.html" class="external-link">usethis::use_data</a></code> to embed data in a package
there is inevitably a reminder to document your data. When you are
embedding a dataframe <code>interfacer</code> can inspect your dataframe
and generate a template data documentation into <code>R/data.R</code> at
the same this as embedding the data to ease this pain.</p>
<p>This is triggered with a call to, for example,
<code>interfacer::use_dataframe(mtcars)</code> which will create an
entry in <code>R/data.R</code> for your dataframe documentation.</p>
<p>This function uses the <code>interfacer</code> framework to generate
the documentation but does not need it afterwards, so you can use this
without putting interfacer in your description file, if that is all you
want to use the package for.</p>
</div>
<div class="section level2">
<h2 id="roxygen2-documentation">
<code>roxygen2</code> documentation<a class="anchor" aria-label="anchor" href="#roxygen2-documentation"></a>
</h2>
<p><code>@iparam &lt;name&gt; &lt;description&gt;</code> tags can be
used in the <code>roxygen2</code> documentation of an
<code>interfacer</code> enabled function. This enables
<code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code> to automatically write the
documentation for dataframe parameters. It may require that you call
<code><a href="https://ai4ci.github.io/interfacer/">library(interfacer)</a></code> before running
<code><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">devtools::document()</a></code>. In this example, the
<code>@iparam</code> tag will be expanded to include the documentation
of the expected input as defined in the <code>iface</code> specification
of the <code>df</code> parameter:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' A function</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @iparam df An input dataframe</span></span>
<span><span class="co">#' @return ... something ...</span></span>
<span><span class="va">test_function</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span> <span class="op">=</span> <span class="fu">interfacer</span><span class="fu">::</span><span class="fu"><a href="../reference/iface.html">iface</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="va">integer</span> <span class="op">~</span> <span class="st">"An integer value"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">=</span> <span class="fu">interfacer</span><span class="fu">::</span><span class="fu"><a href="../reference/ivalidate.html">ivalidate</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span>  <span class="co"># ... main function body ...</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The <code>@iparam</code> tag picks the <code>iface</code>
specification from the current function and parameter. A more flexible
alternative is provided by <code><a href="../reference/idocument.html">idocument()</a></code> which allows you to
specify the function and parameter you wish to document. This is useful
if documenting a generic function that may dispatch to multiple
functions based on the dataframe structures. In the future we will try
and automate this.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This may be defined in the file R/interfaces.R</span></span>
<span><span class="va">i_type1</span> <span class="op">=</span> <span class="fu">interfacer</span><span class="fu">::</span><span class="fu"><a href="../reference/iface.html">iface</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="va">integer</span> <span class="op">~</span> <span class="st">"An integer value"</span><span class="op">)</span></span>
<span><span class="va">i_type2</span> <span class="op">=</span> <span class="fu">interfacer</span><span class="fu">::</span><span class="fu"><a href="../reference/iface.html">iface</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="va">date</span> <span class="op">~</span> <span class="st">"A date value"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' A multiple dispatch function</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @param df An input dataframe conforming to one of:</span></span>
<span><span class="co">#' `r interfacer::idocument(test_function.type1, df)`</span></span>
<span><span class="co">#' or</span></span>
<span><span class="co">#' `r interfacer::idocument(test_function.type2, df)` </span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @return ... something ...</span></span>
<span><span class="va">test_function</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">interfacer</span><span class="fu">::</span><span class="fu"><a href="../reference/idispatch.html">idispatch</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>    test_function.type1 <span class="op">=</span> <span class="va">i_type1</span>,</span>
<span>    test_function.type2 <span class="op">=</span> <span class="va">i_type2</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">test_function.type1</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span> <span class="op">=</span> <span class="va">i_type1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># ... deal with integer input ...</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">test_function.type1</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span> <span class="op">=</span> <span class="va">i_type2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># ... deal with date input ...</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Return values using the <code>roxygen2</code> <code>@ireturn</code>
tag that picks up format definitions from the (first) call to
<code>ireturn(value, spec)</code> in the function body. This is then
used to describe the format of the output dataframe.</p>
<p>If, as in the previous example, the <code>iface</code> definitions
are defined as package local variables it is also possible to refer
directly to these variables in the documentation where they will be
expanded to their definition.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This can be defined in another file such as R/interfaces.R</span></span>
<span><span class="va">i_input_type</span> <span class="op">=</span> <span class="fu">interfacer</span><span class="fu">::</span><span class="fu"><a href="../reference/iface.html">iface</a></span><span class="op">(</span>col1 <span class="op">=</span> <span class="va">integer</span> <span class="op">~</span> <span class="st">"An integer value"</span><span class="op">)</span></span>
<span><span class="va">i_return_type</span> <span class="op">=</span> <span class="fu">interfacer</span><span class="fu">::</span><span class="fu"><a href="../reference/iface.html">iface</a></span><span class="op">(</span>output <span class="op">=</span> <span class="va">date</span> <span class="op">~</span> <span class="st">"A date value"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' An example function</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' The parameter and return values will be expanded to describe the</span></span>
<span><span class="co">#' input and output dataframe formats defined above.</span></span>
<span><span class="co">#' </span></span>
<span><span class="co">#' @iparam df An input dataframe</span></span>
<span><span class="co">#' @ireturn A description of the output dataframe</span></span>
<span><span class="co">#' </span></span>
<span><span class="va">test_function</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span> <span class="op">=</span> <span class="va">i_input_type</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">=</span> <span class="fu">interfacer</span><span class="fu">::</span><span class="fu"><a href="../reference/ivalidate.html">ivalidate</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span>  <span class="co"># ... main function body ...</span></span>
<span>  <span class="fu">interfacer</span><span class="fu">::</span><span class="fu"><a href="../reference/ireturn.html">ireturn</a></span><span class="op">(</span> <span class="va">...output...</span> , <span class="va">i_return_type</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robert Challen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
